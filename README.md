#Серверная часть супер проекта pepo


##Описание REST API pepo-сервиса


### Формат объектов

#### Твит
	{
	    "id": 133, 		// идентификатор твита
	    "author": 17,	// идентификатор автора
	    "content": "tweet text ok ok ok ok. hello",		// содержание
	    "timestamp": "2016-12-12 10:45:33",			// дата создания
	    "extras": [
	        {"tweet_id": null},				// если это ретвит, то идентификатор его "родительского" твита
	        {"image": "http://cool-image.ru/1.jpg"},	// если в твите картинка, то ссылка на неё
	        {"url": null},					// ???
	        {"geo": null}					// гео-метка
	    ]
	}

#### Учётная запись пользователя

	{
		"id": 17,
		"login": "iivan",
		"firstName": "Ivan",
		"lastName": "Ivanov",
		"photo": "http://cool-image.ru/2.jpg",
		"folowers": 17,
		"friends": 3
	}

----------

### Начальная страница

>GET  /

1. Если пользователь аутентифицирован, 
	1. Если в его записи в базе есть поле *login*, то перенаправление на интерфесную часть **/feed**
	1. Иначе на /signup
1. Иначе на /auth

----------

### Аутентификация

>GET  /auth/vk
>GET  /auth/fb

* Точки входа для аутентификации через соответствующую службу. Интерфейс выполняет перенаправление на эти точки в зависимости от выбора пользователя. После выполнения процедуры аутентификации, пользователь перенаправляется на стартовую страницу.

----------

### Учётные записи

>GET  /api/user/

* Получение данных своего профиля аутентифицированного пользователя(ФИО, ссылку на аватарку, и т.д. См. *формат данных пользователя*)
	Коды ответов:
	* 200 --- в поле ответа передаётся JSON содержащий объект пользователя. content-type: application/json
	* 403 --- (здесь и далее) "пользователь не аутентифицирован или его аутентификационный маркер устарел". При получении данного ответа, интерфейс должен выполнить переход на соответствующую точку аутентификации пользователя.

	
>POST /api/user/

* Выполнить регистрацию в системе или редактировать профиль. Тело ответа должно содержать JSON со следующими полями: *login*(это поле должно быть только первый раз при регистрации, иначе оно игнорируется), *firstName*, *lastName*, *photo*. Формат данных --- multipart/form-data
	* 200
	* 403
	* 409 --- ответ при попытке зарегистрировать пользователя с уже существующим логином. Пользователю необходимо выбрать другой логин.


>GET  /api/user/:login 	

- профиль пользователя (JSON с данными пользователя по login)
	- 200 --- в теле ответа JSON с объектом пользователя
	- 403
	- 404 --- если такой пользователь не обнаружен

>~~POST /api/user/:login~~

- ~~редактировать профиль пользователя (не уверен, что это нужно, работает только для самого себя)~~
	- ~~200~~
	- ~~403~~
	- ~~404~~


>GET  /api/user/:login/follower

- список фоловеров указанного пользователя, по умолчанию, первые 50. Параметры:
	- limit - количество для передачи, 
	- offset - количество уже полученных
- Ответы
	- 200 --- в теле ответа JSON с массивом объектов пользователя
	- 403 --- (тут могут быть правила, например, только подписчик может увидеть список фоловеров)
	- 404


>GET  /api/user/:login/friends

- список на кого подписан указанный пользователь, по умолчанию, первые 50. Параметры:
	- limit - количество для передачи, 
	- offset - количество уже полученных
- Ответы
	- 200 --- в теле ответа JSON с массивом объектов пользователя
	- 403 --- (тут могут быть правила, например, только подписчик может увидеть список фоловеров)
	- 404


>POST /api/user/:login/friends

- подписаться/отписаться на/от ленты пользователя
	- 200 --- (новое состояние, т.е. подписан или нет {friend: true})
	- 403
	- 404 



----------

### Твиты


>GET  /api/user/:login/feed 

- таймлайн --- получить твиты пользователя, параметры: 
	- limit - количество, 
	- offset - id самого старого полученного твита

При этом можно получить твиты свои или тех, кого аутентифицированный пользователь воловерит.
	- 200
	- 403 + при попытке получить чужой фид (того, кого не фоловерим)
	- 404


>POST /api/user/:login/feed

- твитнуть. При твите картинкой, данные должны быть multipart/form-data

	- 200
	- 403 + при попытке запостить на чужой фид
	- 404

>GET  /api/tweet/:id

- получить твит по его id

	- 200 --- JSON обект твит
	- 403 + при попытке получить чужой твит, на который не подписан
	- 404

>POST /api/tweet/:id 

- комментить твит. Отправляется JSON с объектом твитом.

	- 200 
	- 403 + при попытке закоментить чужой твит, на который не подписан
	- 404


>POST /api/tweet/:id/retweet

- ретвитнуть твит

	- 200 
	- 403 + при попытке ретвитнуть чужой твит, на который не подписан
	- 404


